<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Happy Birthday Lucy — 29 wishes</title>
<style>
  :root{
    --font-lead: clamp(26px, 6vw, 54px);
    --font-wish: clamp(18px, 3.6vw, 30px);
    --card-bg: rgba(255,255,255,.06);
    --br: 16px;
    --grad: linear-gradient(270deg,#ff4d6d,#f7aef8,#9b5de5,#00bbf9,#00f5d4,#ff4d6d);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:#07060a;color:#fff;font-family:"Segoe UI",system-ui,-apple-system,Arial,"Noto Color Emoji",sans-serif;overflow:hidden}

  /* fireworks bg */
  canvas#fx{position:fixed;inset:0;z-index:0;background:radial-gradient(circle at 50% 15%,#1a132b 0%,#0c0b12 60%,#07060a 100%)}

  .stage{position:relative;z-index:2;height:100%;display:flex;flex-direction:column;align-items:center;padding:16px 16px 120px}
  .hdr{display:flex;gap:10px;align-items:center;justify-content:center;flex-wrap:wrap;text-align:center;margin-top:6px}
  .title{margin:0;font-weight:900;letter-spacing:.4px;font-size:clamp(22px,4.8vw,46px);
    background:var(--grad);background-size:1200% 1200%;
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    animation:grad 12s ease infinite;text-shadow:0 0 24px rgba(255,255,255,.18)}
  .count{padding:.35rem .7rem;border:1px solid rgba(255,255,255,.2);border-radius:999px;font-weight:600;font-size:14px;opacity:.85;backdrop-filter:blur(6px);background:rgba(255,255,255,.06)}
  @keyframes grad{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}

  .controls{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap;justify-content:center}
  button.ui{border:1px solid rgba(255,255,255,.25);background:rgba(255,255,255,.08);color:#fff;padding:.6rem .9rem;border-radius:10px;cursor:pointer;font-weight:600;transition:transform .06s ease;backdrop-filter:blur(6px)}
  button.ui:active{transform:scale(.98)}

  .panel{width:min(960px,94vw);margin-top:14px;background:var(--card-bg);border:1px solid rgba(255,255,255,.08);border-radius:var(--br);padding:16px;flex:1 1 auto;overflow:auto;box-shadow:0 10px 30px rgba(0,0,0,.35) inset,0 10px 30px rgba(0,0,0,.25)}

  .lead{text-align:center;margin:2px 0 14px 0;font-weight:900;font-size:var(--font-lead);
    background:var(--grad);background-size:1200% 1200%;
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    animation:grad 14s ease infinite;text-shadow:0 0 18px rgba(255,255,255,.2)}

  /* ===== Hàng–ô: mỗi hàng 2 cell → luôn thẳng cột ===== */
  .list { display:flex; flex-direction:column; gap:12px; }
  .row  { display:flex; gap:22px; align-items:stretch; }
  .cell { flex:1 1 0; min-width:0; display:flex; }

  .wish{
    font-size:var(--font-wish);font-weight:800;line-height:1.25;letter-spacing:.35px;
    background:var(--grad);background-size:1200% 1200%;
    -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    animation:grad 16s ease infinite;
    text-shadow:0 0 18px rgba(255,255,255,.18);
    opacity:0;transform:translateY(10px) scale(.98);
    padding:4px 6px;white-space:normal;word-break:break-word;text-align:left;
    width:100%;display:block;
  }
  .wish.rtl{direction:rtl;text-align:right}
  .wish.in{animation:fadeIn .5s ease forwards}
  .spacer{visibility:hidden}

  @keyframes fadeIn{to{opacity:1;transform:translateY(0) scale(1)}}

  /* cake */
  .cake{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);width:min(360px,70vw);z-index:1;opacity:.95}
  .flame{transform-origin:center;animation:flame .9s ease-in-out infinite}
  @keyframes flame{0%,100%{transform:scale(1) translateY(0)}50%{transform:scale(1.06) translateY(-1px)}}

  .sound-btn{position:fixed;right:16px;bottom:16px;z-index:3;background:rgba(255,255,255,.12);color:#fff;border:1px solid rgba(255,255,255,.25);padding:.7rem 1rem;border-radius:999px;backdrop-filter:blur(6px);cursor:pointer;font-weight:600}
  .hidden{display:none}
</style>
</head>
<body>
  <canvas id="fx"></canvas>

  <div class="stage">
    <div class="hdr">
      <h1 class="title">Happy Birthday, Lucy</h1>
      <span id="count" class="count">0 / 29</span>
    </div>

    <div class="controls">
      <button id="skip" class="ui">Hiện nhanh câu tiếp theo</button>
      <button id="showAll" class="ui">Hiện tất cả còn lại</button>
      <button id="replay" class="ui">Chạy lại từ đầu</button>
    </div>

    <div class="panel" id="panel">
      <div class="lead">Chúc mừng sinh nhật, Lucy</div>
      <div id="list" class="list"></div>
    </div>
  </div>

  <!-- cake -->
  <svg class="cake" viewBox="0 0 600 220" aria-hidden="true">
    <ellipse cx="300" cy="200" rx="220" ry="16" fill="rgba(255,255,255,.08)"/>
    <rect x="120" y="110" width="360" height="70" rx="14" fill="#ffb3c1"/>
    <rect x="140" y="95"  width="320" height="40" rx="12" fill="#ffd6ff"/>
    <path d="M140,120 q20,20 40,0 t40,0 t40,0 t40,0 t40,0 t40,0 q20,20 40,0 v15 h-320z" fill="#fff"/>
    <g transform="translate(300,85)">
      <rect x="-6" y="10" width="12" height="35" rx="3" fill="#9b5de5"/>
      <path class="flame" d="M0,0 C-6,-10 -6,-18 0,-24 C6,-18 6,-10 0,0Z" fill="#ffd166" stroke="#ff9f1c" stroke-width="1"/>
    </g>
  </svg>

  <!-- audio -->
  <audio id="bgm" autoplay loop playsinline preload="auto">
    <source src="https://cdn.jsdelivr.net/gh/anhvu1411/HPBD-@main/happy-birthday-ukulele-version-339062.mp3" type="audio/mpeg">
  </audio>
  <button id="soundBtn" class="sound-btn hidden">🔊 Tap for music</button>

<script>
/* 28 câu – rải 3 câu RTL vào giữa nửa phải */
const LIST = [
  { t:"Happy Birthday, Lucy"},{t:"Joyeux anniversaire, Lucy"},
  {t:"Feliz cumpleaños, Lucy"},{t:"Buon compleanno, Lucy"},
  {t:"生日快乐，露西"},{t:"ルーシー、お誕生日おめでとう"},
  {t:"जन्मदिन मुबारक हो, लूसी"},{t:"Doğum günün kutlu olsun, Lucy"},
  {t:"Selamat hari jadi, Lucy"},{t:"Grattis på födelsedagen, Lucy"},
  {t:"Palju õnne sünnipäevaks, Lucy"},{t:"Sto lat, Lucy"},
  {t:"Alles Gute zum Geburtstag, Lucy"},
  {t:"Feliz aniversário, Lucy"},

  // Right half (14) – mix RTL inside to avoid bunching at bottom
  {t:"С днём рождения, Люси"},
  {t:"生日快樂，露西"},
  {t:"יום הולדת שמח, לוסי", rtl:true},   // RTL 1
  {t:"생일 축하해, 루시"},
  {t:"تولدت مبارک، لوسی", rtl:true},     // RTL 2
  {t:"শুভ জন্মদিন, লুসি"},
  {t:"สุขสันต์วันเกิด, ลูซี่"},
  {t:"Χαρούμενα γενέθλια, Λούσι"},
  {t:"Selamat ulang năm, Lucy".replace("năm","tahun")}, // small fix
  {t:"Všechno nejlepší k narozeninám, Lucy"},
  {t:"عيد ميلاد سعيد، لوسي", rtl:true},   // RTL 3
  {t:"Hyvää syntymäpäivää, Lucy"},
  {t:"Boldog születésnapot, Lucy"},
  {t:"La mulți ani, Lucy"}
]; // 28

/* Hàng–ô: luôn đủ 2 cell/hàng nhờ spacer */
const list = document.getElementById('list');
const panel = document.getElementById('panel');
const countEl = document.getElementById('count');

const HALF = Math.ceil(LIST.length/2);
const LEFT  = LIST.slice(0, HALF);   // 14
const RIGHT = LIST.slice(HALF);      // 14

let row = 0, running=false, revealAll=false;

function makeWish(item){
  const d=document.createElement('div');
  d.className='wish';
  if(item?.rtl) d.classList.add('rtl');
  d.textContent=(item?.t||'').trim();
  return d;
}
function makeSpacer(){
  const d=document.createElement('div');
  d.className='wish spacer';
  d.textContent='.';
  return d;
}
function updateCount(){
  const shown = 1 + list.querySelectorAll('.wish:not(.spacer)').length;
  countEl.textContent = `${shown} / 29`;
}
function addRow(){
  const l = LEFT[row], r = RIGHT[row];

  const rowDiv = document.createElement('div'); rowDiv.className='row';
  const cellL = document.createElement('div'); cellL.className='cell';
  const cellR = document.createElement('div'); cellR.className='cell';

  const wl = l ? makeWish(l) : makeSpacer();
  const wr = r ? makeWish(r) : makeSpacer();

  cellL.appendChild(wl); cellR.appendChild(wr);
  rowDiv.append(cellL, cellR);
  list.appendChild(rowDiv);

  requestAnimationFrame(()=>{ wl.classList.add('in'); wr.classList.add('in'); });

  panel.scrollTop = panel.scrollHeight;
  updateCount();
  row++;
}
async function play(){
  if(running) return; running = true;
  while(row < Math.max(LEFT.length, RIGHT.length)){
    addRow();
    if(!revealAll) await new Promise(r=>setTimeout(r,700));
  }
  running = false;
}

/* Controls */
document.getElementById('skip').onclick   = ()=>{ if(row<Math.max(LEFT.length,RIGHT.length)) addRow(); if(!running) play(); };
document.getElementById('showAll').onclick= ()=>{ revealAll = true; if(!running) play(); };
document.getElementById('replay').onclick = ()=>{
  row=0; revealAll=false; running=false; list.innerHTML=''; updateCount(); play();
};

updateCount(); play();

/* Fireworks */
const c=document.getElementById('fx'),ctx=c.getContext('2d',{alpha:true});let W,H,dpr=Math.min(devicePixelRatio||1,2);
function resize(){W=c.width=Math.floor(innerWidth*dpr);H=c.height=Math.floor(innerHeight*dpr);ctx.setTransform(dpr,0,0,dpr,0,0);}addEventListener('resize',resize);resize();
const sparks=[],palette=['#ff4d6d','#f7aef8','#9b5de5','#00bbf9','#00f5d4','#ffd166','#ff9f1c'];
function burst(x,y){const N=60+Math.random()*40;for(let i=0;i<N;i++){const a=Math.random()*Math.PI*2,v=2+Math.random()*4;sparks.push({x,y,vx:Math.cos(a)*v,vy:Math.sin(a)*v-2,life:60+Math.random()*30,age:0,color:palette[(Math.random()*palette.length)|0]});}}
function loop(){ctx.fillStyle='rgba(7,6,10,.25)';ctx.fillRect(0,0,innerWidth,innerHeight);for(let i=sparks.length-1;i>=0;i--){const p=sparks[i];p.age++;p.x+=p.vx;p.y+=p.vy;p.vy+=0.04;const t=1-p.age/p.life;if(t<=0){sparks.splice(i,1);continue;}ctx.beginPath();ctx.arc(p.x,p.y,2.2*t+0.6,0,Math.PI*2);ctx.fillStyle=p.color;ctx.globalAlpha=Math.max(t,.15);ctx.fill();ctx.globalAlpha=1;}requestAnimationFrame(loop);}loop();setInterval(()=>burst(Math.random()*innerWidth,innerHeight*(.25+.5*Math.random())),1100);addEventListener('click',e=>burst(e.clientX,e.clientY));addEventListener('touchstart',e=>{const t=e.touches[0];burst(t.clientX,t.clientY)},{passive:true});

/* Audio autoplay */
const audio=document.getElementById('bgm'),btn=document.getElementById('soundBtn');audio.volume=.7;
function tryPlay(){return audio.play().then(()=>btn.classList.add('hidden')).catch(()=>btn.classList.remove('hidden'));}
tryPlay();
const unlock=()=>{tryPlay();window.removeEventListener('touchstart',unlock);window.removeEventListener('click',unlock);};
window.addEventListener('touchstart',unlock,{once:true});window.addEventListener('click',unlock,{once:true});
btn.addEventListener('click',tryPlay);
</script>
</body>
</html>
